{% extends "base.html" %}

{% block title %}WatchDoggo - Status Monitor{% endblock %}

{% block navbar_content %}
<div class="navbar-nav ms-auto">
    <button id="refresh-btn" class="btn btn-outline-light btn-sm me-2">
        <i class="bi bi-arrow-clockwise me-1"></i>Refresh
    </button>
    <span id="last-update" class="navbar-text text-light">
        Last updated: <span id="last-update-time">Loading...</span>
    </span>
</div>
{% endblock %}

{% block content %}
        <!-- Status Summary -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <div class="d-flex align-items-center justify-content-center">
                                    <i class="bi bi-check-circle-fill text-success fs-3 me-2"></i>
                                    <div>
                                        <h4 id="operational-count" class="mb-0">0</h4>
                                        <small class="text-muted">Operational</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center justify-content-center">
                                    <i class="bi bi-exclamation-triangle-fill text-warning fs-3 me-2"></i>
                                    <div>
                                        <h4 id="degraded-count" class="mb-0">0</h4>
                                        <small class="text-muted">Degraded</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center justify-content-center">
                                    <i class="bi bi-x-circle-fill text-danger fs-3 me-2"></i>
                                    <div>
                                        <h4 id="down-count" class="mb-0">0</h4>
                                        <small class="text-muted">Down</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="d-flex align-items-center justify-content-center">
                                    <i class="bi bi-question-circle-fill text-secondary fs-3 me-2"></i>
                                    <div>
                                        <h4 id="unknown-count" class="mb-0">0</h4>
                                        <small class="text-muted">Unknown</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loading-indicator" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3 text-muted">Loading service statuses...</p>
        </div>

        <!-- Services Grid -->
        <div id="services-container" style="display: none;">
            <!-- Service categories will be populated by JavaScript -->
        </div>

        <!-- Error Alert -->
        <div id="error-alert" class="alert alert-danger d-none" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <span id="error-message">An error occurred while loading service statuses.</span>
        </div>
    </div>

    <!-- Service Card Template -->
    <template id="service-card-template">
        <div class="col-lg-3 col-md-4 col-sm-6">
            <div class="card service-card h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="status-icon me-3">
                            <!-- Status icon will be inserted here -->
                        </div>
                        <div class="flex-grow-1">
                            <h6 class="card-title mb-1 service-name">Service Name</h6>
                            <small class="text-muted service-status-text">Status</small>
                        </div>
                    </div>
                    <div class="service-details">
                        <div class="row">
                            <div class="col-6">
                                <small class="text-muted d-block">Response Time</small>
                                <span class="service-response-time">-</span>
                            </div>
                            <div class="col-6">
                                <small class="text-muted d-block">Last Checked</small>
                                <span class="service-last-checked">-</span>
                            </div>
                        </div>
                        <div class="mt-2">
                            <small class="text-muted d-block">Message</small>
                            <span class="service-message">-</span>
                        </div>
                        <div class="service-error mt-2" style="display: none;">
                            <small class="text-danger d-block">Error</small>
                            <span class="service-error-text">-</span>
                        </div>
                        <div class="service-link mt-3" style="display: none;">
                            <a href="#" class="btn btn-outline-primary btn-sm service-url-link" target="_blank" rel="noopener">
                                <i class="bi bi-box-arrow-up-right me-1"></i>View Status Page
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

{% endblock %}

{% block extra_js %}
<!-- Custom JS -->
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}